3.<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Selfie Camera</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div id="centerArea" class="center-area">
      <!-- Image used as the generate pair trigger; keep id so existing JS attaches handler -->
      <img id="genCodeBtn" src="camera.png" alt="Generate Pair Code" class="gen-icon" />
      <!-- show the pair code after generation (starts empty) -->
      <div id="pairCodeDisplay" class="code center-code" aria-live="polite"></div>
      <!-- pairing QR (filled when a one-time code is generated) -->
      <div id="pairingQrWrap" style="margin-top:12px;display:none;text-align:center">
        <div style="width:220px;height:220px;margin:0 auto;background:#081224;border-radius:12px;display:flex;align-items:center;justify-content:center">
          <img id="pairingQR" alt="Pairing QR" style="max-width:100%;max-height:100%" />
        </div>
        <div style="margin-top:8px;color:#9fb3c6;font-size:0.95rem">Scan to open remote and connect</div>
      </div>
    </div>

    <main class="wrap">
      <p style="display:none">Simple camera page to register your device, start streaming and generate one-time pairing codes.</p>

      <section class="controls" aria-hidden="true">
        <!-- keep the camera name input in DOM (hidden) so existing JS can read/store it, but hide from users -->
        <input id="cameraNameInput" placeholder="my-phone" style="display:none" />

        <!-- status kept but hidden; scripts may update it for debugging -->
        <div id="status" class="status" style="display:none">Idle</div>
      </section>

      <!-- Preview is hidden until a connection/session is established -->
      <section id="preview" class="preview" style="display:none">
        <video id="localVideo" autoplay playsinline muted></video>
        <div id="captured" class="captured"></div>
      </section>
    </main>

    <script type="module" src="main.js"></script>
    <!-- QR share modal and floating button -->
    <div id="qrModal" style="display:none;position:fixed;inset:0;align-items:center;justify-content:center;background:rgba(0,0,0,0.45);z-index:9999">
      <div style="background:#071021;padding:18px;border-radius:12px;max-width:92vw;max-height:92vh;overflow:auto;color:#e6eef6">
        <h3 style="margin:0 0 8px">Open camera on your phone</h3>
        <p style="margin:0 0 12px;color:#9fb3c6">Scan this code with your phone to open this page.</p>
        <div style="display:flex;justify-content:center">
          <div style="width:260px;height:260px;background:#081224;border-radius:12px;display:flex;align-items:center;justify-content:center">
            <img id="qr-img" alt="QR" style="max-width:100%;max-height:100%" />
          </div>
        </div>
        <div style="text-align:right;margin-top:12px"><button id="qrClose" style="background:#0b1220;color:#e6eef6;border:1px solid rgba(159,179,198,0.08);padding:8px 12px;border-radius:8px;cursor:pointer">Close</button></div>
      </div>
    </div>
    <button id="qrToggle" title="Share this page" style="position:fixed;right:14px;bottom:14px;z-index:9998;background:#0b1220;color:#e6eef6;border:0;padding:10px 12px;border-radius:12px;box-shadow:0 6px 18px rgba(2,10,18,0.6);cursor:pointer">ðŸ”— QR</button>

    <script>
      const origin = (location.protocol === 'file:') ? null : location.origin;
      const pageUrl = origin ? `${origin}${location.pathname}` : location.href;
      function qrImageFor(url, size = 400){
        const encoded = encodeURIComponent(url);
        return `https://chart.googleapis.com/chart?cht=qr&chs=${size}x${size}&chl=${encoded}&choe=UTF-8`;
      }
      document.getElementById('qrToggle').addEventListener('click', () => {
        document.getElementById('qr-img').src = qrImageFor(pageUrl);
        document.getElementById('qrModal').style.display = 'flex';
      });
      document.getElementById('qrClose').addEventListener('click', () => { document.getElementById('qrModal').style.display = 'none'; });
      document.getElementById('qrModal').addEventListener('click', (e) => { if(e.target === e.currentTarget) e.currentTarget.style.display = 'none'; });
    </script>
  </body>
</html>
